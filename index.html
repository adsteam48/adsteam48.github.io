<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>üß† BRAINROT BOARD</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- Babel -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>

<body class="bg-black">
<div id="root"></div>

<script type="text/babel">

const TYPES = {
  exchange: { label: "‰∫§Êèõ", color: "bg-blue-500" },
  flex: { label: "Ëá™ÊÖ¢", color: "bg-purple-500" },
  sale: { label: "Ë≤©Â£≤", color: "bg-green-500" },
};

function BrainrotBoard() {
  const [posts, setPosts] = React.useState([]);
  const [tab, setTab] = React.useState("all");
  const [showModal, setShowModal] = React.useState(false);
  const [selected, setSelected] = React.useState(null);
  const [comment, setComment] = React.useState("");

  const [form, setForm] = React.useState({
    type: "exchange",
    title: "",
    content: "",
    item: "",
    price: ""
  });

  const user = React.useMemo(() => {
    let u = localStorage.getItem("brainrot_user");
    if (!u) {
      u = "User" + Math.floor(Math.random() * 9000 + 1000);
      localStorage.setItem("brainrot_user", u);
    }
    return u;
  }, []);

  React.useEffect(() => {
    const saved = localStorage.getItem("brainrot_posts");
    if (saved) setPosts(JSON.parse(saved));
  }, []);

  const save = (data) => {
    setPosts(data);
    localStorage.setItem("brainrot_posts", JSON.stringify(data));
  };

  const submit = () => {
    if (!form.title || !form.content) return;
    const post = {
      id: Date.now(),
      ...form,
      author: user,
      time: Date.now(),
      likes: 0,
      liked: false,
      comments: []
    };
    save([post, ...posts]);
    setForm({ type: "exchange", title: "", content: "", item: "", price: "" });
    setShowModal(false);
  };

  const like = (id) => {
    save(posts.map(p =>
      p.id === id
        ? { ...p, likes: p.liked ? p.likes - 1 : p.likes + 1, liked: !p.liked }
        : p
    ));
  };

  const addComment = () => {
    if (!comment.trim()) return;
    save(posts.map(p =>
      p.id === selected.id
        ? { ...p, comments: [...p.comments, { text: comment, author: user }] }
        : p
    ));
    setSelected({
      ...selected,
      comments: [...selected.comments, { text: comment, author: user }]
    });
    setComment("");
  };

  const removePost = (id) => {
    save(posts.filter(p => p.id !== id));
    setSelected(null);
  };

  const filtered = tab === "all" ? posts : posts.filter(p => p.type === tab);

  return (
    <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-pink-900 text-white p-6">
      <h1 className="text-5xl font-black text-center mb-6 animate-pulse">
        üß† BRAINROT BOARD üß†
      </h1>

      {/* Tabs */}
      <div className="flex gap-2 justify-center mb-6 flex-wrap">
        {["all","exchange","flex","sale"].map(t => (
          <button key={t}
            onClick={() => setTab(t)}
            className={`px-5 py-2 rounded-full font-bold ${
              tab === t ? "bg-white text-black" : "bg-white/20"
            }`}
          >
            {t === "all" ? "ALL" : TYPES[t].label}
          </button>
        ))}
      </div>

      <button
        onClick={() => setShowModal(true)}
        className="w-full max-w-xl mx-auto block mb-6 bg-pink-500 py-3 rounded-xl font-bold hover:scale-105 transition"
      >
        + Êñ∞Ë¶èÊäïÁ®ø
      </button>

      {/* Posts */}
      <div className="max-w-xl mx-auto space-y-4">
        {filtered.length === 0 && (
          <p className="text-center text-white/60">„Åæ„Å†ÊäïÁ®ø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>
        )}
        {filtered.map(p => (
          <div key={p.id} className="bg-white/10 p-5 rounded-xl">
            <div className="flex justify-between items-start mb-2">
              <span className={`${TYPES[p.type].color} px-3 py-1 rounded-full text-sm`}>
                {TYPES[p.type].label}
              </span>
              {p.author === user && (
                <button onClick={() => removePost(p.id)} className="text-red-400">ÂâäÈô§</button>
              )}
            </div>
            <h3 className="text-xl font-bold">{p.title}</h3>
            <p className="mt-2">{p.content}</p>
            {p.item && <p className="mt-2">üì¶ {p.item}</p>}
            {p.price && <p className="text-yellow-300">üí∞ ¬•{p.price}</p>}
            <div className="flex gap-4 mt-3 text-sm">
              <button onClick={() => like(p.id)}>‚ù§Ô∏è {p.likes}</button>
              <button onClick={() => setSelected(p)}>üí¨ {p.comments.length}</button>
            </div>
          </div>
        ))}
      </div>

      {/* New Post Modal */}
      {showModal && (
        <div className="fixed inset-0 bg-black/70 flex items-center justify-center">
          <div className="bg-purple-800 p-6 rounded-xl w-full max-w-md">
            <h2 className="text-2xl font-bold mb-4">Êñ∞Ë¶èÊäïÁ®ø</h2>
            <select
              className="w-full mb-2 p-2 rounded bg-black/30"
              value={form.type}
              onChange={e => setForm({...form, type: e.target.value})}
            >
              <option value="exchange">‰∫§Êèõ</option>
              <option value="flex">Ëá™ÊÖ¢</option>
              <option value="sale">Ë≤©Â£≤</option>
            </select>
            <input className="w-full mb-2 p-2 rounded bg-black/30"
              placeholder="„Çø„Ç§„Éà„É´"
              value={form.title}
              onChange={e => setForm({...form, title: e.target.value})}
            />
            <textarea className="w-full mb-2 p-2 rounded bg-black/30"
              placeholder="ÂÜÖÂÆπ"
              value={form.content}
              onChange={e => setForm({...form, content: e.target.value})}
            />
            <input className="w-full mb-2 p-2 rounded bg-black/30"
              placeholder="„Ç¢„Ç§„ÉÜ„É†"
              value={form.item}
              onChange={e => setForm({...form, item: e.target.value})}
            />
            {form.type === "sale" && (
              <input className="w-full mb-2 p-2 rounded bg-black/30"
                placeholder="‰æ°Ê†º"
                value={form.price}
                onChange={e => setForm({...form, price: e.target.value})}
              />
            )}
            <button onClick={submit} className="w-full bg-pink-500 py-2 rounded font-bold">
              ÊäïÁ®ø
            </button>
            <button onClick={() => setShowModal(false)} className="w-full mt-2 bg-white/20 py-2 rounded">
              „Ç≠„É£„É≥„Çª„É´
            </button>
          </div>
        </div>
      )}

      {/* Comment Modal */}
      {selected && (
        <div className="fixed inset-0 bg-black/70 flex items-center justify-center">
          <div className="bg-purple-800 p-6 rounded-xl w-full max-w-md">
            <h3 className="text-xl font-bold mb-2">{selected.title}</h3>
            <div className="space-y-2 max-h-60 overflow-y-auto mb-3">
              {selected.comments.map((c,i) => (
                <div key={i} className="bg-white/10 p-2 rounded">
                  {c.text}
                  <div className="text-xs text-yellow-300">{c.author}</div>
                </div>
              ))}
            </div>
            <input
              className="w-full p-2 rounded bg-black/30 mb-2"
              placeholder="„Ç≥„É°„É≥„Éà"
              value={comment}
              onChange={e => setComment(e.target.value)}
            />
            <button onClick={addComment} className="w-full bg-pink-500 py-2 rounded">
              ÈÄÅ‰ø°
            </button>
            <button onClick={() => setSelected(null)} className="w-full mt-2 bg-white/20 py-2 rounded">
              Èñâ„Åò„Çã
            </button>
          </div>
        </div>
      )}
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<BrainrotBoard />);

</script>
</body>
</html>
